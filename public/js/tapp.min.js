const streamer=window.location.pathname.split("/")[2];let toggle_alert=function(toggle){let alert_elem=document.getElementById("alert");var start_text="loading "+streamer+"'s stream. please wait";if(toggle){alert_elem.innerText=start_text,alert_elem.style.display="block";var i=0;return setInterval(function(){4==++i?(alert_elem.innerText=start_text,i=0):alert_elem.innerText+="."},250)}return alert_elem.innerText="",alert_elem.style.display="none",-1!=alert_interval_id&&clearInterval(alert_interval_id),-1},init_player=function(){var embed={width:window.innerWidth,height:window.innerHeight,channel:streamer,parent:["test"]},embed=new Twitch.Embed("vid",embed);const player=embed._player;var start_time=Date.now();let player_state_id=setInterval(function(){var state=player.getPlayerState();if("Playing"===state.playback||"Ready"===state.playback)clearInterval(player_state_id),player_state_id=null,toggle_alert(!1),document.getElementById("vid").style.display="block",player.setQuality(player.getQualities()[1].group);else if(1e4<Date.now()-start_time){clearInterval(player_state_id),toggle_alert(!1);let alert_elem=document.getElementById("alert");alert_elem.innerText="player load timeout.\n"+streamer+"is either not live, or an error occurred.\ntry again later, or try another streamer that is live.",alert_elem.style.display="block"}},1e3);return embed},alert_interval_id=toggle_alert(!0);const embed=init_player();window.onresize=function(){embed._iframe.width=window.innerWidth,embed._iframe.height=window.innerHeight};
